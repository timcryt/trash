tuple = {"(" ~ " "* ~ (constr ~ " "+)* ~ constr* ~ ")"}
call  = {" "* ~ constr ~ " "* ~ (constr ~ " "+)* ~ constr*}
call_expr  = _{"[" ~ " "* ~ call ~ " "* ~ "]"}
line  = _{" "* ~ call? ~ "\n"}
clojure_inner = @{(" " | "\n")* ~ (call ~ "\n")* ~ call ~ (" " | "\n")*}
clojure = _{"{" ~ clojure_inner ~ "}"}

literal = _{"\"" ~ literal_inner ~ "\""}
literal_inner = @{(!"\"" ~ ANY)+}

string = {('a'..'z' | '0'..'9' | 'A'..'Z' | "_")+}
ident = @{("$" |"@") ~ string}

constr = _{tuple | string | literal | ident | call_expr | clojure}

code = {SOI ~ line* ~ call? ~ EOI}